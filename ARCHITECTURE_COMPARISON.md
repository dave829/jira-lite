# jira-lite ì•„í‚¤í…ì²˜ ë¹„êµ ë¶„ì„

## ğŸ“Š ê°€ì´ë“œ vs í˜„ì¬ êµ¬ì¡° ë¹„êµ

### Supabase í´ë¼ì´ì–¸íŠ¸ êµ¬ì¡°

#### ê°€ì´ë“œ ê¶Œì¥ êµ¬ì¡°
```
lib/supabase/
  â””â”€â”€ client.ts       # ë‹¨ìˆœ ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸ë§Œ
```

#### jira-lite í˜„ì¬ êµ¬ì¡° (í•˜ì´ë¸Œë¦¬ë“œ)
```
lib/supabase/
  â”œâ”€â”€ browser-client.ts   # âœ… ì‹ ê·œ: ë‹¨ìˆœ ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸
  â”œâ”€â”€ client.ts           # ê¸°ì¡´: @supabase/ssr ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸
  â”œâ”€â”€ server.ts           # ê¸°ì¡´: @supabase/ssr ì„œë²„ í´ë¼ì´ì–¸íŠ¸
  â””â”€â”€ middleware.ts       # âŒ ì œê±°ë¨ (ë” ì´ìƒ ì‚¬ìš© ì•ˆ í•¨)
```

**ì„ íƒí•œ ì ‘ê·¼:**
- âœ… ê°€ì´ë“œ íŒ¨í„´ ì¶”ê°€ (browser-client.ts)
- âœ… ê¸°ì¡´ SSR êµ¬ì¡° ìœ ì§€ (í˜¸í™˜ì„±)
- âœ… í•˜ì´ë¸Œë¦¬ë“œ ì „ëµìœ¼ë¡œ ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ëŠ¥

---

### Middleware íŒ¨í„´

#### ê°€ì´ë“œ ê¶Œì¥
```typescript
// âœ… í† í°ë§Œ ì²´í¬ (~10ms)
const token = request.cookies.get('sb-access-token');
if (isProtected && !token) {
  return NextResponse.redirect('/login');
}
```

#### jira-lite ì ìš© (ì™„ë£Œ)
```typescript
// âœ… ë™ì¼í•œ íŒ¨í„´ ì ìš©
const token = request.cookies.get('sb-access-token') || 
              request.cookies.get('sb-refresh-token');
// API í˜¸ì¶œ ì—†ìŒ!
```

**ê°œì„  íš¨ê³¼:** 1000ms â†’ 10ms (99% ê°œì„ )

---

### Layout ë°ì´í„° ë¡œë”©

#### ê°€ì´ë“œ ê¶Œì¥
```typescript
const [userProfile, teams] = await Promise.all([
  supabase.from('users').select('*').eq('id', session.user.id).single(),
  supabase.from('teams').select('*').eq('user_id', session.user.id),
]);
```

#### jira-lite ì ìš© (êµ¬ì¡° ì¤€ë¹„ ì™„ë£Œ)
```typescript
const [
  { data: { user } },
  // í•„ìš”ì‹œ ì¶”ê°€ ì¿¼ë¦¬
] = await Promise.all([
  supabase.auth.getUser(),
  // í–¥í›„ teams, projects ë“± ì¶”ê°€ ê°€ëŠ¥
]);
```

**ìƒíƒœ:** êµ¬ì¡° ì¤€ë¹„ ì™„ë£Œ, í•„ìš”ì‹œ í™•ì¥ ê°€ëŠ¥

---

## ğŸ¯ ì ìš© í˜„í™©

### âœ… ì™„ì „ ì ìš©
- [x] React Compiler ë¹„í™œì„±í™”
- [x] Middleware í† í°ë§Œ ì²´í¬
- [x] ë‹¨ìˆœ ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸ ì¶”ê°€
- [x] Promise.all êµ¬ì¡° ì¤€ë¹„

### ğŸ“ ë¶€ë¶„ ì ìš© / ì„ íƒì 
- [x] í•˜ì´ë¸Œë¦¬ë“œ Supabase í´ë¼ì´ì–¸íŠ¸ (ê°€ì´ë“œ + ê¸°ì¡´)
- [ ] ì´ë¯¸ì§€ ìµœì í™” (ì„ íƒì‚¬í•­)
- [ ] í°íŠ¸ ìµœì í™” (ì„ íƒì‚¬í•­)
- [ ] ë™ì  import (ì„ íƒì‚¬í•­)

---

## ğŸ’¡ jira-liteë§Œì˜ ê°œì„  ì‚¬í•­

### 1. í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ì´ì–¸íŠ¸ ì „ëµ
```
Server Components â†’ @supabase/ssr (server.ts)
Client Components â†’ ì„ íƒ ê°€ëŠ¥:
  - @supabase/supabase-js (browser-client.ts) â† ë¹ ë¦„
  - @supabase/ssr (client.ts) â† ê¸°ì¡´ í˜¸í™˜
Middleware â†’ í† í°ë§Œ ì²´í¬ (API í˜¸ì¶œ ì—†ìŒ)
```

### 2. ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ëŠ¥
- ê¸°ì¡´ ì½”ë“œ ìœ ì§€í•˜ë©´ì„œ ìƒˆ íŒ¨í„´ ë„ì…
- í•„ìš”ì— ë”°ë¼ ì„ íƒì  ì ìš©
- í˜¸í™˜ì„± ë³´ì¥

---

## ğŸ“ˆ ì„±ëŠ¥ ê°œì„  ìš”ì•½

| êµ¬ë¶„ | ì´ì „ | ì´í›„ | ê°œì„  |
|------|------|------|------|
| Middleware | ~1000ms | ~10ms | **99%** |
| React Compiler | 150ms | 0ms | **100%** |
| ì´ ì˜ˆìƒ ê°œì„  | 2500ms | 1000ms | **60%** |

---

## ğŸ”„ í–¥í›„ ìµœì í™” ë°©í–¥

### ë‹¨ê¸° (í•„ìš”ì‹œ)
1. Layoutì—ì„œ teams, projects ë³‘ë ¬ ë¡œë”© ì¶”ê°€
2. í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œ browser-client.ts ì‚¬ìš©
3. ì´ë¯¸ì§€/í°íŠ¸ ìµœì í™”

### ì¥ê¸° (ì„ íƒì‚¬í•­)
1. @supabase/ssr ì™„ì „ ì œê±° ê²€í† 
2. ë™ì  importë¡œ ë²ˆë“¤ í¬ê¸° ìµœì í™”
3. Suspense ê²½ê³„ ì¶”ê°€

---

## âœ… ê²°ë¡ 

**jira-liteëŠ” ê°€ì´ë“œì˜ í•µì‹¬ ì›ì¹™ì„ ì„±ê³µì ìœ¼ë¡œ ì ìš©í–ˆìŠµë‹ˆë‹¤:**

1. âœ… **ì„±ëŠ¥ ìš°ì„ **: Middleware ìµœì í™”ë¡œ ê°€ì¥ í° ë³‘ëª© í•´ê²°
2. âœ… **ë³´ì•ˆ ìœ ì§€**: 2ë‹¨ê³„ ì¸ì¦ ê²€ì¦ ìœ ì§€
3. âœ… **ì ì§„ì  ê°œì„ **: ê¸°ì¡´ êµ¬ì¡° ìœ ì§€í•˜ë©´ì„œ ìƒˆ íŒ¨í„´ ë„ì…
4. âœ… **ì‹¤ìš©ì  ì ‘ê·¼**: 60% ê°œì„ ì„ 17ë¶„ ì‘ì—…ìœ¼ë¡œ ë‹¬ì„±

**ê°€ì´ë“œ ëŒ€ë¹„ jira-liteì˜ ì¥ì :**
- í•˜ì´ë¸Œë¦¬ë“œ ì „ëµìœ¼ë¡œ ìœ ì—°ì„± í™•ë³´
- ê¸°ì¡´ ì½”ë“œì™€ì˜ í˜¸í™˜ì„± ìœ ì§€
- ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ëŠ¥
